{"version":3,"sources":["webpack:///./src/components/hotel/order/AllotRoom.vue?5468","webpack:///src/components/hotel/order/AllotRoom.vue","webpack:///./src/components/hotel/order/AllotRoom.vue?d78f","webpack:///./src/components/hotel/order/AllotRoom.vue?8fcd","webpack:///./src/components/hotel/order/AllotRoom.vue?2acd"],"names":["render","_vm","this","_h","$createElement","_c","_self","attrs","width","title","mask-closable","on","on-visible-change","openOrClose","model","value","callback","$$v","isOpen","expression","isAllot","staticClass","span","_v","_s","orderReserve","roomTypeName","roomTypePrice","reserveNum","allottedNum","_e","staticStyle","margin-top","margin-bottom","_l","item","index","key","type","size","filterable","placeholder","disabled","on-change","$event","setRoomInfo","$set","v","roomName","isDisabled","roomNo","prefix","number","clearable","placement","format","startFormat","readonly","onlyRead","endFormat","orderTypeCode","max","min","formatter","parser","replace","directives","name","rawName","orderRooms","length","roomNum","icon","click","handleRoomAdd","handleRoomRemove","slot","loading","allotRoomLoad","submit","submitCheckIn","staticRenderFns","AllotRoomvue_type_script_lang_js_","props","openIs","Boolean","Object","order","String","checkInOrderRooms","Array","data","isRooms","isOk","computed","objectSpread","vuex_esm","roomStates","state","room","watch","_openIs","mounted","loadRoomStates","methods","val","getRoomsByType","roomTypeId","console","log","forEach","or","inTime","Date","estimateInTime","outTime","estimateOutTime","day","getDate","rs","assign_default","$emit","$data","$options","_this","tag","$Message","error","then","res","code","success","msg","_this2","json","reserved","i","_this3","filter","push","roomPrice","guestName","guestTel","guestCertificateNo","otherGuestCertificateNos","reserveId","orderNo","pop","order_AllotRoomvue_type_script_lang_js_","component","componentNormalizer","__webpack_exports__","_node_modules_mini_css_extract_plugin_dist_loader_js_ref_6_oneOf_1_0_node_modules_css_loader_index_js_ref_6_oneOf_1_1_node_modules_vue_loader_lib_loaders_stylePostLoader_js_node_modules_postcss_loader_src_index_js_ref_6_oneOf_1_2_node_modules_cache_loader_dist_cjs_js_ref_0_0_node_modules_vue_loader_lib_index_js_vue_loader_options_AllotRoom_vue_vue_type_style_index_0_lang_css___WEBPACK_IMPORTED_MODULE_0__","__webpack_require__","_node_modules_mini_css_extract_plugin_dist_loader_js_ref_6_oneOf_1_0_node_modules_css_loader_index_js_ref_6_oneOf_1_1_node_modules_vue_loader_lib_loaders_stylePostLoader_js_node_modules_postcss_loader_src_index_js_ref_6_oneOf_1_2_node_modules_cache_loader_dist_cjs_js_ref_0_0_node_modules_vue_loader_lib_index_js_vue_loader_options_AllotRoom_vue_vue_type_style_index_0_lang_css___WEBPACK_IMPORTED_MODULE_0___default","n"],"mappings":"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","file":"js/allotRoom-legacy.860de82c.js","sourcesContent":["var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',[_c('Modal',{attrs:{\"width\":\"800\",\"title\":_vm.title,\"mask-closable\":false},on:{\"on-visible-change\":_vm.openOrClose},model:{value:(_vm.isOpen),callback:function ($$v) {_vm.isOpen=$$v},expression:\"isOpen\"}},[_c('Form',[('allot'===_vm.isAllot)?_c('div',{staticClass:\"allotRoom\"},[_c('Row',[_c('Col',{attrs:{\"span\":3}},[_vm._v(\"\\n          \"+_vm._s(_vm.orderReserve?_vm.orderReserve.roomTypeName:'')+\"\\n          \")]),_c('Col',{attrs:{\"span\":6}},[_vm._v(\"\\n          预订房价： \"+_vm._s(_vm.orderReserve?_vm.orderReserve.roomTypePrice:'')+\" 元/间/晚\\n          \")]),_c('Col',{attrs:{\"span\":4}},[_vm._v(\"\\n          预订数量： \"+_vm._s(_vm.orderReserve?_vm.orderReserve.reserveNum:'')+\" 间\\n          \")]),_c('Col',{attrs:{\"span\":4}},[_vm._v(\"\\n          已分配： \"+_vm._s(_vm.orderReserve?_vm.orderReserve.allottedNum:'')+\" 间\\n          \")])],1)],1):_vm._e(),_c('Divider',{staticStyle:{\"margin-top\":\"24\",\"margin-bottom\":\"24px\"}}),_c('div',_vm._l((_vm.orderRooms),function(item,index){return _c('Row',{key:index},[_c('Col',{attrs:{\"span\":1}},[_c('Icon',{attrs:{\"type\":\"md-home\",\"size\":\"28\"}})],1),_c('Col',{attrs:{\"span\":4}},[_c('FormItem',[_c('Select',{staticStyle:{\"width\":\"120px\"},attrs:{\"filterable\":\"\",\"placeholder\":\"请选择房号\",\"disabled\":'allot'!==_vm.isAllot},on:{\"on-change\":function($event){return _vm.setRoomInfo(index)}},model:{value:(item.roomNo),callback:function ($$v) {_vm.$set(item, \"roomNo\", $$v)},expression:\"item.roomNo\"}},_vm._l((_vm.isRooms),function(v){return _c('Option',{key:v.roomName,attrs:{\"disabled\":_vm.isDisabled(v.roomNo),\"value\":v.roomNo}},[_vm._v(_vm._s(v.roomName)+\"-\"+_vm._s(v.roomTypeName)+\"\\n              \")])}),1)],1)],1),_c('Col',{attrs:{\"span\":4}}),_c('Col',{attrs:{\"span\":4}},[_c('FormItem',[_c('Input',{staticStyle:{\"width\":\"120px\"},attrs:{\"prefix\":\"logo-yen\",\"placeholder\":\"请输入房价\",\"number\":\"\",\"clearable\":\"\"},model:{value:(item.roomPrice),callback:function ($$v) {_vm.$set(item, \"roomPrice\", $$v)},expression:\"item.roomPrice\"}})],1)],1),_c('Col',{attrs:{\"span\":6}},[_c('FormItem',[_c('DatePicker',{staticStyle:{\"width\":\"75px\"},attrs:{\"type\":\"date\",\"placement\":\"bottom-end\",\"placeholder\":\"时间\",\"format\":_vm.startFormat,\"readonly\":_vm.onlyRead},model:{value:(item.estimateInTime),callback:function ($$v) {_vm.$set(item, \"estimateInTime\", $$v)},expression:\"item.estimateInTime\"}}),_vm._v(\"--\\n            \"),_c('DatePicker',{staticStyle:{\"width\":\"75px\"},attrs:{\"type\":\"date\",\"placement\":\"bottom-end\",\"placeholder\":\"时间\",\"format\":_vm.endFormat,\"readonly\":_vm.onlyRead},model:{value:(item.estimateOutTime),callback:function ($$v) {_vm.$set(item, \"estimateOutTime\", $$v)},expression:\"item.estimateOutTime\"}})],1)],1),_c('Col',{attrs:{\"span\":3}},[_c('FormItem',[(item.orderTypeCode === 'daily')?_c('InputNumber',{attrs:{\"max\":100,\"min\":1,\"formatter\":function (value) { return (value + \" 晚\"); },\"parser\":function (value) { return value.replace(' 晚', ''); },\"readonly\":_vm.onlyRead},model:{value:(item.day),callback:function ($$v) {_vm.$set(item, \"day\", $$v)},expression:\"item.day\"}}):_vm._e()],1)],1),_c('Col',{attrs:{\"span\":2}},[(0 === index)?_c('FormItem',[_c('Button',{directives:[{name:\"show\",rawName:\"v-show\",value:(_vm.orderRooms.length < _vm.roomNum),expression:\"orderRooms.length < roomNum\"}],attrs:{\"type\":\"error\",\"icon\":\"md-add\",\"size\":\"small\"},on:{\"click\":_vm.handleRoomAdd}}),_vm._v(\" \\n            \"),_c('Button',{directives:[{name:\"show\",rawName:\"v-show\",value:(_vm.orderRooms.length > 1),expression:\"orderRooms.length > 1\"}],attrs:{\"type\":\"error\",\"icon\":\"md-remove\",\"size\":\"small\"},on:{\"click\":_vm.handleRoomRemove}})],1):_vm._e()],1)],1)}),1)],1),_c('div',{attrs:{\"slot\":\"footer\"},slot:\"footer\"},[_c('Button',{attrs:{\"size\":\"large\"},on:{\"click\":function($event){_vm.isOpen = false;}}},[_vm._v(\"取消\")]),('allot'===_vm.isAllot)?_c('Button',{attrs:{\"type\":\"primary\",\"size\":\"large\",\"loading\":_vm.allotRoomLoad},on:{\"click\":_vm.submit}},[_vm._v(\"确定\")]):_vm._e(),('checkIn'===_vm.isAllot)?_c('Button',{attrs:{\"type\":\"primary\",\"size\":\"large\",\"loading\":_vm.allotRoomLoad},on:{\"click\":_vm.submitCheckIn}},[_vm._v(\"确定\")]):_vm._e()],1)],1)],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\r\n  <div>\r\n    <Modal\r\n      width=\"800\"\r\n      v-model=\"isOpen\"\r\n      :title=\"title\"\r\n      :mask-closable=\"false\"\r\n      @on-visible-change=\"openOrClose\"\r\n    >\r\n      <Form>\r\n        <div\r\n          class=\"allotRoom\"\r\n          v-if=\"'allot'===isAllot\"\r\n        >\r\n          <Row>\r\n            <Col :span=\"3\">\r\n            {{orderReserve?orderReserve.roomTypeName:''}}\r\n            </Col>\r\n            <Col :span=\"6\">\r\n            预订房价： {{orderReserve?orderReserve.roomTypePrice:''}} 元/间/晚\r\n            </Col>\r\n            <Col :span=\"4\">\r\n            预订数量： {{orderReserve?orderReserve.reserveNum:''}} 间\r\n            </Col>\r\n            <Col :span=\"4\">\r\n            已分配： {{orderReserve?orderReserve.allottedNum:''}} 间\r\n            </Col>\r\n          </Row>\r\n        </div>\r\n        <Divider style=\"margin-top: 24; margin-bottom: 24px;\" />\r\n        <div>\r\n          <Row\r\n            v-for=\"(item, index) in orderRooms\"\r\n            :key=\"index\"\r\n          >\r\n            <Col :span=\"1\">\r\n            <Icon\r\n              type=\"md-home\"\r\n              size=\"28\"\r\n            />\r\n            </Col>\r\n            <Col :span=\"4\">\r\n            <FormItem>\r\n              <Select\r\n                v-model=\"item.roomNo\"\r\n                filterable\r\n                @on-change=\"setRoomInfo(index)\"\r\n                style=\"width: 120px\"\r\n                placeholder=\"请选择房号\"\r\n                :disabled=\"'allot'!==isAllot\"\r\n              >\r\n                <Option\r\n                  v-for=\"v in isRooms\"\r\n                  :disabled=\"isDisabled(v.roomNo)\"\r\n                  :value=\"v.roomNo\"\r\n                  :key=\"v.roomName\"\r\n                >{{ v.roomName }}-{{ v.roomTypeName }}\r\n                </Option>\r\n              </Select>\r\n            </FormItem>\r\n            </Col>\r\n            <Col :span=\"4\">\r\n            <!-- <FormItem>\r\n            <RadioGroup\r\n              v-model=\"item.orderTypeCode\"\r\n              @on-change=\"setHourRoom(index,$event)\"\r\n            >\r\n              <Radio label=\"daily\">日租</Radio>\r\n              <Radio label=\"hour_room\">钟点</Radio>\r\n            </RadioGroup>\r\n          </FormItem> -->\r\n            </Col>\r\n            <Col :span=\"4\">\r\n            <FormItem>\r\n              <Input\r\n                v-model=\"item.roomPrice\"\r\n                prefix=\"logo-yen\"\r\n                placeholder=\"请输入房价\"\r\n                number\r\n                style=\"width: 120px\"\r\n                clearable\r\n              />\r\n            </FormItem>\r\n            </Col>\r\n            <Col :span=\"6\">\r\n            <FormItem>\r\n              <DatePicker\r\n                v-model=\"item.estimateInTime\"\r\n                type=\"date\"\r\n                placement=\"bottom-end\"\r\n                placeholder=\"时间\"\r\n                :format=\"startFormat\"\r\n                style=\"width: 75px\"\r\n                :readonly=\"onlyRead\"\r\n              ></DatePicker>--\r\n              <DatePicker\r\n                v-model=\"item.estimateOutTime\"\r\n                type=\"date\"\r\n                placement=\"bottom-end\"\r\n                placeholder=\"时间\"\r\n                :format=\"endFormat\"\r\n                style=\"width: 75px\"\r\n                :readonly=\"onlyRead\"\r\n              ></DatePicker>\r\n            </FormItem>\r\n            </Col>\r\n            <Col :span=\"3\">\r\n            <FormItem>\r\n              <InputNumber\r\n                v-if=\"item.orderTypeCode === 'daily'\"\r\n                :max=\"100\"\r\n                :min=\"1\"\r\n                v-model=\"item.day\"\r\n                :formatter=\"value => `${value} 晚`\"\r\n                :parser=\"value => value.replace(' 晚', '')\"\r\n                :readonly=\"onlyRead\"\r\n              ></InputNumber>\r\n              <!-- <InputNumber\r\n              v-if=\"item.orderTypeCode === 'hour_room'\"\r\n              :max=\"3\"\r\n              :min=\"3\"\r\n              v-model=\"defaultHour\"\r\n              readonly\r\n              :formatter=\"value => `${value} 小时`\"\r\n              :parser=\"value => value.replace(' 小时', '')\"\r\n              @on-change=\"setOutTime(index,$event)\"\r\n            ></InputNumber> -->\r\n            </FormItem>\r\n            </Col>\r\n            <Col :span=\"2\">\r\n            <FormItem v-if=\"0 === index\">\r\n              <Button\r\n                v-show=\"orderRooms.length < roomNum\"\r\n                type=\"error\"\r\n                icon=\"md-add\"\r\n                size=\"small\"\r\n                @click=\"handleRoomAdd\"\r\n              ></Button>&nbsp;\r\n              <Button\r\n                v-show=\"orderRooms.length > 1\"\r\n                type=\"error\"\r\n                icon=\"md-remove\"\r\n                size=\"small\"\r\n                @click=\"handleRoomRemove\"\r\n              ></Button>\r\n            </FormItem>\r\n            </Col>\r\n          </Row>\r\n        </div>\r\n      </Form>\r\n      <div slot=\"footer\">\r\n        <Button\r\n          size=\"large\"\r\n          @click=\"isOpen = false;\"\r\n        >取消</Button>\r\n        <Button\r\n          v-if=\"'allot'===isAllot\"\r\n          type=\"primary\"\r\n          size=\"large\"\r\n          :loading=\"allotRoomLoad\"\r\n          @click=\"submit\"\r\n        >确定</Button>\r\n        <Button\r\n          v-if=\"'checkIn'===isAllot\"\r\n          type=\"primary\"\r\n          size=\"large\"\r\n          :loading=\"allotRoomLoad\"\r\n          @click=\"submitCheckIn\"\r\n        >确定</Button>\r\n      </div>\r\n    </Modal>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport { mapState, mapActions, mapGetters } from \"vuex\";\r\nimport { allotRoom,checkIn } from \"@/api/order.js\";\r\nexport default {\r\n  name: \"AllotRoom\",\r\n  props: {\r\n    openIs: Boolean,\r\n    orderReserve: Object,\r\n    order: Object,\r\n    isAllot: String,\r\n    checkInOrderRooms: Array\r\n  },\r\n  data() {\r\n    return {\r\n      isOpen: false,\r\n      title: \"分配房间\",\r\n      allotRoomLoad: false,\r\n      orderRooms: [],\r\n      startFormat: \"MM-dd\",\r\n      endFormat: \"MM-dd HH:mm\",\r\n      isRooms: null,\r\n      onlyRead: false,\r\n      isOk: false\r\n    };\r\n  },\r\n  computed: {\r\n    roomNum() {\r\n      if (\"allot\" === this.isAllot) {\r\n        return this.orderReserve.reserveNum - this.orderReserve.allottedNum;\r\n      }\r\n      return 0;\r\n    },\r\n    ...mapState({\r\n      roomStates: state => state.room.roomStates\r\n    }),\r\n    ...mapGetters([\"getRoomsByType\"])\r\n  },\r\n  watch: {\r\n    openIs(openIs) {\r\n      this.isOpen = openIs;\r\n    }\r\n  },\r\n  mounted() {\r\n    if (null === this.roomStates) {\r\n      this.loadRoomStates();\r\n    }\r\n  },\r\n  methods: {\r\n    openOrClose(val) {\r\n      if (!val) {\r\n        this.$emit(\"allot-room-close\", this.isOk);\r\n        Object.assign(this.$data, this.$options.data());\r\n      } else {\r\n        this.isRooms = this.getRoomsByType(\r\n          this.orderReserve ? this.orderReserve.roomTypeId : null\r\n        );\r\n        if (\"allot\" === this.isAllot) {\r\n          this.title = \"分配房间\";\r\n          this.onlyRead = true;\r\n          for (let index = 0; index < this.roomNum; index++) {\r\n            this.handleRoomAdd();\r\n          }\r\n        }\r\n        if (\"checkIn\" === this.isAllot) {\r\n          this.title = \"办理入住\";\r\n          this.onlyRead = true;\r\n          console.log(this.checkInOrderRooms);\r\n\r\n          this.checkInOrderRooms.forEach(or => {\r\n            let inTime = new Date(or.estimateInTime);\r\n            let outTime = new Date(or.estimateOutTime);\r\n            let day = outTime.getDate() - inTime.getDate();\r\n            or.estimateInTime = inTime;\r\n            or.estimateOutTime = outTime;\r\n            or.day = day;\r\n          });\r\n          let rs = [];\r\n          Object.assign(rs, this.checkInOrderRooms);\r\n          this.orderRooms = rs;\r\n        }\r\n      }\r\n    },\r\n    submit() {\r\n      this.allotRoomLoad = true;\r\n      let tag = true;\r\n      this.orderRooms.forEach(or => {\r\n        if (or.roomNo === null || or.roomNo === \"\") {\r\n          tag = false;\r\n          this.$Message.error(\"请选择房号\");\r\n          return false;\r\n        }\r\n      });\r\n      console.log(this.orderRooms);\r\n      if (tag) {\r\n        allotRoom({ orderRooms: this.orderRooms }).then(res => {\r\n          if (res.data.code === 0) {\r\n            this.isOk = true;\r\n            this.isOpen = false;\r\n            this.$Message.success(\"分配房间成功\");\r\n          } else {\r\n            this.$Message.error(res.data.code + \"：\" + res.data.msg);\r\n            this.allotRoomLoad = false;\r\n          }\r\n        });\r\n      }\r\n    },\r\n    submitCheckIn() {\r\n      this.allotRoomLoad = true;\r\n      let json = {\r\n        'order': this.order,\r\n        'orderRooms': this.orderRooms,\r\n        'reserved': true\r\n      }\r\n      checkIn(json).then(res => {\r\n        if (res.data.code === 0) {\r\n          this.isOk = true;\r\n          this.isOpen = false;\r\n          this.$emit(\"load-room-state\");\r\n         this.$Message.success('办理入住成功');\r\n         \r\n\r\n        } else {\r\n          this.$Message.error(res.data.code + \"：\" + res.data.msg);\r\n          this.allotRoomLoad = false;\r\n        }\r\n      });\r\n    },\r\n    isDisabled(roomNo) {\r\n      let tag = false;\r\n      this.orderRooms.forEach(or => {\r\n        if (roomNo === or.roomNo) {\r\n          tag = true;\r\n        }\r\n      });\r\n      return tag;\r\n    },\r\n    setRoomInfo(i) {\r\n      let room = this.isRooms.filter(\r\n        room => room.roomNo === this.orderRooms[i].roomNo\r\n      );\r\n      if (room && room.length > 0) {\r\n        this.orderRooms[i].roomName = room[0].roomName;\r\n        this.orderRooms[i].roomTypeName = room[0].roomTypeName;\r\n        //  this.orderRooms[i].roomPrice = room[0].roomTypePrice;\r\n      }\r\n    },\r\n    handleRoomAdd() {\r\n      let inTime = new Date(this.orderReserve.estimateInTime);\r\n      let outTime = new Date(this.orderReserve.estimateOutTime);\r\n      let day = outTime.getDate() - inTime.getDate();\r\n      this.orderRooms.push({\r\n        roomName: \"\",\r\n        roomNo: \"\",\r\n        roomTypeName: \"\",\r\n        roomPrice: this.orderReserve.roomTypePrice,\r\n        guestName: this.order.guestName,\r\n        guestTel: this.order.guestTel || null,\r\n        guestCertificateNo: this.order.guestCertificateNo || null,\r\n        otherGuestCertificateNos: null,\r\n        // 日租/钟点\r\n        orderTypeCode: \"daily\",\r\n        // 预计入住时间\r\n        estimateInTime: inTime,\r\n        // 预计推翻时间\r\n        estimateOutTime: outTime,\r\n        reserveId: this.orderReserve.reserveId,\r\n        orderNo: this.orderReserve.orderNo,\r\n        day: day\r\n      });\r\n    },\r\n    handleRoomRemove() {\r\n      if (this.orderRooms.length > 1) {\r\n        this.orderRooms.pop();\r\n      }\r\n    },\r\n    ...mapActions([\"loadRoomStates\"])\r\n  }\r\n};\r\n</script>\r\n\r\n<style>\r\n.allotRoom {\r\n  font: 1.1em sans-serif;\r\n  font-weight: bold;\r\n}\r\n</style>\r\n","import mod from \"-!../../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../../node_modules/thread-loader/dist/cjs.js!../../../../node_modules/babel-loader/lib/index.js!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./AllotRoom.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../../node_modules/thread-loader/dist/cjs.js!../../../../node_modules/babel-loader/lib/index.js!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./AllotRoom.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./AllotRoom.vue?vue&type=template&id=565fc52b&\"\nimport script from \"./AllotRoom.vue?vue&type=script&lang=js&\"\nexport * from \"./AllotRoom.vue?vue&type=script&lang=js&\"\nimport style0 from \"./AllotRoom.vue?vue&type=style&index=0&lang=css&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","import mod from \"-!../../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../../../node_modules/css-loader/index.js??ref--6-oneOf-1-1!../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./AllotRoom.vue?vue&type=style&index=0&lang=css&\"; export default mod; export * from \"-!../../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../../../node_modules/css-loader/index.js??ref--6-oneOf-1-1!../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./AllotRoom.vue?vue&type=style&index=0&lang=css&\""],"sourceRoot":""}