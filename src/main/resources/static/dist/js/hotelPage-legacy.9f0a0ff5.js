(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["hotelPage"],{"080b":function(e,t,o){"use strict";var n=o("80fb"),r=o.n(n);r.a},"58bb":function(e,t,o){"use strict";var n=o("d65b"),r=o.n(n);r.a},"7f7f":function(e,t,o){var n=o("86cc").f,r=Function.prototype,s=/^\s*function ([^ (]*)/,a="name";a in r||o("9e1e")&&n(r,a,{configurable:!0,get:function(){try{return(""+this).match(s)[1]}catch(e){return""}}})},"80fb":function(e,t,o){},a17c:function(e,t,o){},ab83:function(e,t,o){"use strict";o.r(t);var n=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",[o("Layout",{style:{minHeight:"100vh"}},[o("Header",{staticClass:"header"},[o("Menu",{attrs:{mode:"horizontal","active-name":e.currentMenu}},[o("div",{staticClass:"layout-logo"},[e._v("\n          来客酒店云管家\n          ")]),o("div",{staticClass:"layout-logo"},[e._v("\n          "+e._s(e.currHotel&&e.currHotel.hotelName?e.currHotel.hotelName:"")+"\n        ")]),o("div",{staticClass:"layout-nav"},[o("MenuItem",{attrs:{name:"/roomState",to:"/roomState"}},[e._v("房态")]),o("MenuItem",{attrs:{name:"/order",to:"/order"}},[e._v("订单")]),o("MenuItem",{attrs:{name:"/guest",to:"/guest"}},[e._v("会员")]),o("MenuItem",{attrs:{name:"/report",to:"/report"}},[e._v("报表")]),o("MenuItem",{attrs:{name:"/setting",to:"/setting"}},[e._v("设置")])],1),o("div",{staticClass:"layout-user"},[o("a",{on:{click:function(t){e.myInfo.openIs=!0},mousemove:function(t){e.avatarSize="large"},mouseout:function(t){e.avatarSize="default"}}},[o("Avatar",{style:{background:"#f56a00"},attrs:{size:e.avatarSize}},[e._v(e._s(e.headText))])],1)])])],1),o("Content",[o("router-view")],1)],1),o("LoginModal"),o("MyInfo",{attrs:{"open-is":e.myInfo.openIs},on:{"my-info-close":function(t){e.myInfo.openIs=!1}}})],1)},r=[],s=o("cebc"),a=(o("cadf"),o("551c"),o("f751"),o("097d"),o("52c1")),i=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",[o("modal",{attrs:{width:"400",closable:!1,"mask-closable":!1,"footer-hide":""},model:{value:e.openIs,callback:function(t){e.openIs=t},expression:"openIs"}},[o("p",{staticStyle:{"text-align":"center"},attrs:{slot:"header"},slot:"header"},[e._v("登录超时，请重新登录")]),o("Form",{ref:"loginForm",attrs:{model:e.loginInfo,rules:e.loginRule}},[o("FormItem",{attrs:{prop:"mobileNum"}},[o("Input",{staticStyle:{height:"40px"},attrs:{width:"40",size:"large",prefix:"md-phone-portrait",placeholder:"请输入手机号"},model:{value:e.loginInfo.mobileNum,callback:function(t){e.$set(e.loginInfo,"mobileNum",t)},expression:"loginInfo.mobileNum"}})],1),o("FormItem",{attrs:{prop:"userPwd"}},[o("Input",{ref:"pwdInput",attrs:{size:"large",type:"password",prefix:"md-lock",placeholder:"请输入密码"},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.submit(t)}},model:{value:e.loginInfo.userPwd,callback:function(t){e.$set(e.loginInfo,"userPwd",t)},expression:"loginInfo.userPwd"}})],1),o("FormItem",[o("Button",{attrs:{size:"large",type:"primary",long:""},on:{click:e.submit}},[e._v("登录")])],1)],1)],1)],1)},l=[],c={name:"LoginModal",props:{url:String},data:function(){return{openIs:!1,loginInfo:{mobileNum:null,userPwd:null},loginRule:{mobileNum:[{required:!0,message:"请输入手机号"}],userPwd:[{required:!0,message:"请输入密码"}]}}},computed:Object(s["a"])({},Object(a["e"])({isLogin:function(e){return e.user.isLogin},isFirst:function(e){return e.user.isFirst},currUser:function(e){return e.user.currUser}})),watch:{isLogin:function(e){var t=this;e?(this.openIs=!1,this.$Message.success("登录成功！"),this.$refs.loginForm.resetFields()):0!==this.isFirst&&(this.openIs=!0,this.loginInfo.mobileNum=this.currUser.mobileNum,this.$nextTick(function(){return t.$refs["pwdInput"].focus()}))}},methods:Object(s["a"])({submit:function(){var e=this;this.$refs.loginForm.validate(function(t){t&&e.login(e.loginInfo)})}},Object(a["b"])({login:"login"}))},u=c,d=(o("58bb"),o("2877")),p=Object(d["a"])(u,i,l,!1,null,null,null),m=p.exports,f=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",[o("Drawer",{attrs:{width:"300"},on:{"on-visible-change":e.openOrClose},model:{value:e.isOpen,callback:function(t){e.isOpen=t},expression:"isOpen"}},[o("div",{},[o("center",[o("Avatar",{style:{background:"#f56a00"},attrs:{size:"large"}},[e._v(e._s(e.headText))]),o("h1",[e._v(e._s(e.currUser.realName))]),o("h3",[e._v("系统到期时间： \n                  "+e._s(e.currHotel&&e.currHotel.activationEndTime?new Date(e.currHotel.activationEndTime).Format("yyyy-MM-dd hh:mm"):"")+"\n              ")])],1),o("Row",[o("Col",{attrs:{span:10}},[o("Button",{on:{click:function(t){e.pwdIsOpen=!0}}},[e._v("修改密码")])],1),o("Col",{staticStyle:{float:"right"},attrs:{span:10}},[o("Button",{on:{click:e.logout}},[e._v("退出系统")])],1)],1)],1),o("div",[o("Divider",{attrs:{orientation:"left"}},[e._v("当班信息")]),o("Alert",{attrs:{type:"success"}},[e._v("当  班 人 ："+e._s(e.onDutyInfo.onComingRealName?e.onDutyInfo.onComingRealName:"无"))]),o("Alert",{attrs:{type:"success"}},[e._v("接班时间："+e._s(e.onDutyInfo.onComingTime?e.onDutyInfo.onComingTime:"第一次"))]),o("Alert",{attrs:{type:"success"}},[e._v("接班现金 ：\n              "),o("span",{staticClass:"redFont"},[e._v("\n              "+e._s(e.onDutyInfo.lastHandoverCash?e.onDutyInfo.lastHandoverCash:"第一次")+" \n              ")]),e._v(" 元\n          ")]),o("Button",{attrs:{type:"error",long:""},on:{click:function(t){e.handoverIsOpen=!0}}},[e._v("交 班")]),o("Divider",{attrs:{orientation:"left"}},[e._v("收银台")]),o("Alert",{attrs:{type:"success"}},[e._v("\n              当前现金 ：\n              "),o("span",{staticClass:"redFont"},[e._v("\n              "+e._s(e.onDutyInfo.currentCash?e.onDutyInfo.currentCash:"0")+"\n              ")]),e._v("\n               元\n              "),o("template",{slot:"desc"},[o("div",{attrs:{slot:"content"},slot:"content"},[e._v("\n                      接班现金： \n                      "),o("span",{staticClass:"redFont"},[e._v("\n                      +"+e._s(e.onDutyInfo.lastHandoverCash?e.onDutyInfo.lastHandoverCash:"第一次")+"\n                      ")]),e._v("\n                        元 "),o("br"),e._l(e.cashFlowInfo,function(t,n){return 0!=t.money?o("p",{key:n},[e._v("\n                          "+e._s(t.item)+"： \n                          "),o("span",{staticClass:"redFont"},[e._v("\n                          "+e._s(t.money>0?"+"+t.money:t.money)+"\n                          ")]),e._v("\n                            元\n                      ")]):e._e()}),e._v("\n                      结余： "+e._s(e.onDutyInfo.currentCash?e.onDutyInfo.currentCash:"0")+" 元\n                  ")],2)])],2),o("Alert",{attrs:{type:"success"}},[e._v("\n              订单结余：\n              "),o("span",{staticClass:"redFont"},[e._v("\n                  "+e._s(e.onDutyInfo.currentOrderBalance?e.onDutyInfo.currentOrderBalance:0)+" \n              ")]),e._v("\n                  元\n              "),o("template",{slot:"desc"},[o("div",{attrs:{slot:"content"},slot:"content"},e._l(e.onDutyInfo.orderInOut,function(t,n){return o("p",{key:n},[e._v("\n                          "+e._s(e.codeToText(t.payMethodCode))+"：收入:"+e._s(t.income)+" \n                          "),e._v("\n                          支出:"+e._s(t.outgoings)+" \n                           结余:"+e._s(t.balance)+" \n                      ")])}),0)])],2),o("Button",{attrs:{type:"error",long:""},on:{click:function(t){e.cashTitle="财务收账",e.collectIsOpen=!0}}},[e._v("财务收账")]),o("p",[e._v(" ")]),o("Button",{attrs:{type:"error",long:""},on:{click:function(t){e.cashTitle="添加备用金",e.collectIsOpen=!0}}},[e._v("添加备用金")])],1)]),o("modal",{attrs:{width:"400","mask-closable":!1,"footer-hide":""},on:{"on-visible-change":e.pwdOpenOrClose},model:{value:e.pwdIsOpen,callback:function(t){e.pwdIsOpen=t},expression:"pwdIsOpen"}},[o("p",{staticStyle:{"text-align":"center"},attrs:{slot:"header"},slot:"header"},[e._v("修改密码")]),o("Form",{ref:"pwdsForm",attrs:{model:e.pwds,rules:e.pwdsRule}},[o("FormItem",{attrs:{prop:"oldPwd"}},[o("Input",{staticStyle:{height:"40px"},attrs:{type:"password",size:"large",prefix:"md-lock",placeholder:"请输入旧密码"},model:{value:e.pwds.oldPwd,callback:function(t){e.$set(e.pwds,"oldPwd",t)},expression:"pwds.oldPwd"}})],1),o("FormItem",{attrs:{prop:"newPwd"}},[o("Input",{attrs:{size:"large",type:"password",prefix:"md-lock",placeholder:"请输入新密码"},model:{value:e.pwds.newPwd,callback:function(t){e.$set(e.pwds,"newPwd",t)},expression:"pwds.newPwd"}})],1),o("FormItem",{attrs:{prop:"newPwd2"}},[o("Input",{attrs:{size:"large",type:"password",prefix:"md-lock",placeholder:"请再次输入新密码"},model:{value:e.pwds.newPwd2,callback:function(t){e.$set(e.pwds,"newPwd2",t)},expression:"pwds.newPwd2"}})],1),o("FormItem",[o("Button",{attrs:{size:"large",type:"primary",long:""},on:{click:e.pwdsSubmit}},[e._v("确认修改")])],1)],1)],1),o("modal",{attrs:{width:"400","mask-closable":!1,"footer-hide":""},on:{"on-visible-change":e.handoverOpenOrClose},model:{value:e.handoverIsOpen,callback:function(t){e.handoverIsOpen=t},expression:"handoverIsOpen"}},[o("p",{staticStyle:{"text-align":"center"},attrs:{slot:"header"},slot:"header"},[e._v("交接班")]),o("Form",{ref:"handoverForm",attrs:{model:e.handover,rules:e.handoverRule}},[o("FormItem",{attrs:{prop:"offGoingPwd"}},[o("Input",{staticStyle:{height:"40px"},attrs:{type:"password",size:"large",prefix:"md-lock",placeholder:"请输入交班人密码"},model:{value:e.handover.offGoingPwd,callback:function(t){e.$set(e.handover,"offGoingPwd",t)},expression:"handover.offGoingPwd"}})],1),o("FormItem",{attrs:{prop:"onComingMobile"}},[o("Input",{attrs:{size:"large",prefix:"md-phone-portrait",placeholder:"请接班人输入手机号"},model:{value:e.handover.onComingMobile,callback:function(t){e.$set(e.handover,"onComingMobile",t)},expression:"handover.onComingMobile"}})],1),o("FormItem",{attrs:{prop:"onComingPwd"}},[o("Input",{attrs:{size:"large",type:"password",prefix:"md-lock",placeholder:"请接班人输入密码"},model:{value:e.handover.onComingPwd,callback:function(t){e.$set(e.handover,"onComingPwd",t)},expression:"handover.onComingPwd"}})],1),o("FormItem",[o("Button",{attrs:{size:"large",type:"primary",loading:e.handoverLoad,long:""},on:{click:e.handoverSubmit}},[e._v("确认交班")])],1)],1)],1),o("Modal",{attrs:{width:"400","mask-closable":!1,"footer-hide":""},on:{"on-visible-change":e.collectOpenOrClose},model:{value:e.collectIsOpen,callback:function(t){e.collectIsOpen=t},expression:"collectIsOpen"}},[o("Alert",{attrs:{type:"success"}},[e._v("\n              当前现金：\n              "),o("span",{staticClass:"redFont"},[e._v("\n                  "+e._s(e.onDutyInfo.currentCash?e.onDutyInfo.currentCash:"0")+"\n              ")]),e._v("\n                  元\n          ")]),o("p",{staticStyle:{"text-align":"center"},attrs:{slot:"header"},slot:"header"},[e._v(e._s(e.cashTitle))]),o("Form",{ref:"collectForm",attrs:{model:e.collect,rules:e.collectRule}},[o("FormItem",{attrs:{prop:"flowMoney"}},[o("Input",{attrs:{size:"large",prefix:"md-phone-portrait",placeholder:"请输入"+e.cashTitle+"金额"},model:{value:e.collect.flowMoney,callback:function(t){e.$set(e.collect,"flowMoney",t)},expression:"collect.flowMoney"}})],1),o("FormItem",{attrs:{prop:"userPwd"}},[o("Input",{attrs:{size:"large",type:"password",prefix:"md-lock",placeholder:"请输入密码"},model:{value:e.collect.userPwd,callback:function(t){e.$set(e.collect,"userPwd",t)},expression:"collect.userPwd"}})],1),o("FormItem",[o("Button",{attrs:{size:"large",type:"primary",loading:e.collectLoad,long:""},on:{click:e.cashSubmit}},[e._v("确认"+e._s(e.cashTitle))])],1)],1)],1)],1)},h=[],g=(o("7f7f"),o("ac6a"),o("7ded")),v=o("7f43"),w=o.n(v),y="/api/handover",I=function(e){return w.a.post(y,e)},b=function(){return w.a.get(y+"/duty")},_="/api/finance",O=function(e){return w.a.post(_+"/collect",e)},C=function(e){return w.a.post(_+"/addCash",e)},F={name:"MyInfo",props:{openIs:Boolean,printInfo:Object},filters:{},data:function(){return{isOpen:!1,printLoad:!1,pwdIsOpen:!1,handoverIsOpen:!1,collectIsOpen:!1,collectLoad:!1,handoverLoad:!1,cashTitle:"财务收账",pwds:{oldPwd:"",newPwd:"",newPwd2:""},handover:{offGoingPwd:"",onComingMobile:"",onComingPwd:""},collect:{flowMoney:"",userPwd:""},pwdsRule:{oldPwd:[{required:!0,message:"请输入旧密码"}],newPwd:[{required:!0,message:"请输入新密码"}],newPwd2:[{required:!0,message:"请再次输入新密码"}]},handoverRule:{offGoingPwd:[{required:!0,message:"请交班人输入密码"}],onComingMobile:[{required:!0,message:"请接班人输入手机号"}],onComingPwd:[{required:!0,message:"请接班人输入密码"}]},collectRule:{cashMoney:[{required:!0,message:"请输入收款金额"}],userPwd:[{required:!0,message:"请输入密码"}]},onDutyInfo:{}}},computed:Object(s["a"])({headText:function(){return this.currUser&&this.currUser.realName?this.currUser.realName.charAt(0):"囧"},cashFlowInfo:function(){var e=0,t=0,o=0,n=0;if(this.onDutyInfo.otherFrontCashFlows&&this.onDutyInfo.otherFrontCashFlows.forEach(function(n){"collect_cash"===n.itemCode?e+=n.flowMoney:"income"===n.flowType?t+=n.flowMoney:o+=n.flowMoney}),this.onDutyInfo.orderInOut){var r=this.onDutyInfo.orderInOut.filter(function(e){return"cash"===e.payMethodCode});n=r[0]?r[0].balance:0}var s=[{money:n,item:"订单结余"},{money:-e,item:"财务收账"},{money:t,item:"其它收入"},{money:o,item:"其它支出"}];return s}},Object(a["e"])({isLogin:function(e){return e.user.isLogin},isFirst:function(e){return e.user.isFirst},currUser:function(e){return e.user.currUser},currHotel:function(e){return e.user.currHotel},inout:function(e){return e.dic.inout},pay_method:function(e){return e.dic.pay_method}}),Object(a["c"])(["codeToText"])),mounted:function(){},watch:{openIs:function(e){this.isOpen=e}},methods:Object(s["a"])({openOrClose:function(e){e?this.getOnDutyInfo():this.$emit("my-info-close")},pwdOpenOrClose:function(e){e||this.restForm("pwdsForm")},handoverOpenOrClose:function(e){e||this.restForm("handoverForm")},collectOpenOrClose:function(e){e||this.restForm("collectForm")},pwdsSubmit:function(){var e=this;this.$refs.pwdsForm.validate(function(t){t&&(console.log(e.pwds.newPwd),console.log(e.pwds.newPwd2),e.pwds.newPwd===e.pwds.newPwd2?Object(g["a"])(e.pwds).then(function(t){0===t.data.code?(e.$Message.success("密码修改成功，请重新登录"),e.pwdIsOpen=!1,e.logout()):e.$Message.error(t.data.code+"："+t.data.msg)}):e.$Message.error("两次新密码不一致"))})},handoverSubmit:function(){var e=this;this.$refs.handoverForm.validate(function(t){t&&(console.log(e.handover),e.handoverLoad=!0,I(e.handover).then(function(t){0===t.data.code?(e.$Message.success("交接班成功，请接班人重新登录"),e.handoverIsOpen=!1,e.handoverLoad=!1,e.logout()):(e.$Message.error(t.data.code+"："+t.data.msg),e.handoverLoad=!1)}))})},cashSubmit:function(){var e=this;this.$refs.collectForm.validate(function(t){t&&(e.collectLoad=!0,console.log(e.collect),"财务收账"===e.cashTitle&&O(e.collect).then(function(t){0===t.data.code?(e.$Message.success("收账成功"),e.collectIsOpen=!1,e.collectLoad=!1,e.getOnDutyInfo()):(e.$Message.error(t.data.code+"："+t.data.msg),e.collectLoad=!1)}),"添加备用金"===e.cashTitle&&C(e.collect).then(function(t){0===t.data.code?(e.$Message.success("添加备用金成功"),e.collectIsOpen=!1,e.collectLoad=!1,e.getOnDutyInfo()):(e.$Message.error(t.data.code+"："+t.data.msg),e.collectLoad=!1)}))})},getOnDutyInfo:function(){var e=this;b().then(function(t){0===t.data.code?e.onDutyInfo=t.data.data:e.$Message.error(t.data.code+"："+t.data.msg)})},restForm:function(e){console.log(e),console.log(this.$refs),this.$refs[e].resetFields()}},Object(a["b"])({logout:"logout",loadDic:"loadDic"}))},M=F,L=(o("080b"),Object(d["a"])(M,f,h,!1,null,null,null)),P=L.exports,k={name:"HotelPage",components:{LoginModal:m,MyInfo:P},data:function(){return{appHeight:window.innerHeight,currentMenu:"/roomState",myInfo:{openIs:!1},avatarSize:"default"}},computed:Object(s["a"])({headText:function(){return this.currUser&&this.currUser.realName?this.currUser.realName.charAt(0):"囧"}},Object(a["e"])({isLogin:function(e){return e.user.isLogin},isFirst:function(e){return e.user.isFirst},currUser:function(e){return e.user.currUser},currHotel:function(e){return e.user.currHotel}})),watch:{isLogin:function(e){if(console.log("isLogin",e),console.log("isFirst",this.isFirst),!e&&0===this.isFirst){var t=encodeURIComponent(this.$route.path);this.$router.push("/login/"+t)}}},mounted:function(){this.getCurrUser(),"/"===this.$route.path&&this.$router.push("roomState"),this.currentMenu=this.$route.path,this.loadDic("pay_method"),this.loadDic("channel")},methods:Object(s["a"])({},Object(a["b"])({getCurrUser:"currUser",loadDic:"loadDic"}))},x=k,S=(o("d9c9"),Object(d["a"])(x,n,r,!1,null,null,null));t["default"]=S.exports},ac6a:function(e,t,o){for(var n=o("cadf"),r=o("0d58"),s=o("2aba"),a=o("7726"),i=o("32e9"),l=o("84f2"),c=o("2b4c"),u=c("iterator"),d=c("toStringTag"),p=l.Array,m={CSSRuleList:!0,CSSStyleDeclaration:!1,CSSValueList:!1,ClientRectList:!1,DOMRectList:!1,DOMStringList:!1,DOMTokenList:!0,DataTransferItemList:!1,FileList:!1,HTMLAllCollection:!1,HTMLCollection:!1,HTMLFormElement:!1,HTMLSelectElement:!1,MediaList:!0,MimeTypeArray:!1,NamedNodeMap:!1,NodeList:!0,PaintRequestList:!1,Plugin:!1,PluginArray:!1,SVGLengthList:!1,SVGNumberList:!1,SVGPathSegList:!1,SVGPointList:!1,SVGStringList:!1,SVGTransformList:!1,SourceBufferList:!1,StyleSheetList:!0,TextTrackCueList:!1,TextTrackList:!1,TouchList:!1},f=r(m),h=0;h<f.length;h++){var g,v=f[h],w=m[v],y=a[v],I=y&&y.prototype;if(I&&(I[u]||i(I,u,p),I[d]||i(I,d,v),l[v]=p,w))for(g in n)I[g]||s(I,g,n[g],!0)}},d65b:function(e,t,o){},d9c9:function(e,t,o){"use strict";var n=o("a17c"),r=o.n(n);r.a}}]);
//# sourceMappingURL=hotelPage-legacy.9f0a0ff5.js.map