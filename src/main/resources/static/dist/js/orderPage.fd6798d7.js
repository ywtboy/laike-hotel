(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["orderPage"],{1938:function(e,t,r){"use strict";r.r(t);var i=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("Layout",{style:{height:e.conHeight+"px"}},[r("Sider",[r("Menu",{style:{height:"100%"},attrs:{theme:"light","active-name":"all",width:"auto"}},[r("MenuGroup",{attrs:{title:"订单查询"}},[r("MenuItem",{attrs:{name:"all"},nativeOn:{click:function(t){return e.queryClassified("all")}}},[e._v("\n        全部订单\n        ")]),r("MenuItem",{attrs:{name:"live"},nativeOn:{click:function(t){return e.queryClassified("live")}}},[e._v("\n        当前正住\n        ")]),r("MenuItem",{attrs:{name:"out"},nativeOn:{click:function(t){return e.queryClassified("out")}}},[e._v("\n        今日预退\n        ")]),r("MenuItem",{attrs:{name:"today_come"},nativeOn:{click:function(t){return e.queryClassified("today_come")}}},[e._v("\n        今日预到\n        ")]),r("MenuItem",{attrs:{name:"wait_allot"},nativeOn:{click:function(t){return e.queryClassified("wait_allot")}}},[e._v("\n        等待分房\n        ")]),r("MenuItem",{attrs:{name:"no_come"},nativeOn:{click:function(t){return e.queryClassified("no_come")}}},[e._v("\n        预订未到\n        ")])],1)],1)],1),r("Content",{staticClass:"laike-hotel-content"},[r("Row",[r("Col",{attrs:{span:24}},[r("Form",{ref:"queryForm",attrs:{model:e.query,inline:""}},[e.isShowDate?r("FormItem",{attrs:{label:"营业日","label-width":80,prop:"startTime"}},[r("DatePicker",{staticStyle:{width:"120px"},attrs:{type:"date",clearable:"",placement:"bottom-end",placeholder:"开始时间",options:e.options1},on:{"on-change":e.setEndTime},model:{value:e.query.startTime,callback:function(t){e.$set(e.query,"startTime",t)},expression:"query.startTime"}}),e._v("--\n          "),r("DatePicker",{staticStyle:{width:"120px"},attrs:{type:"date",placement:"bottom-end",placeholder:"结束时间",options:e.options1},model:{value:e.query.endTime,callback:function(t){e.$set(e.query,"endTime",t)},expression:"query.endTime"}})],1):e._e(),r("FormItem",{attrs:{prop:"endTime"}}),r("FormItem",{attrs:{prop:"orderNo"}},[r("Input",{attrs:{clearable:"",placeholder:"输入订单号"},model:{value:e.query.orderNo,callback:function(t){e.$set(e.query,"orderNo",t)},expression:"query.orderNo"}})],1),r("FormItem",{attrs:{prop:"guestName"}},[r("Input",{attrs:{clearable:"",placeholder:"输入客人姓名"},model:{value:e.query.guestName,callback:function(t){e.$set(e.query,"guestName",t)},expression:"query.guestName"}})],1),r("FormItem",[r("Button",{attrs:{type:"info"},on:{click:function(t){e.page.page=1,e.getOrderList()}}},[e._v("查询")])],1),r("FormItem",[r("Button",{attrs:{type:"info"},on:{click:function(t){return e.handleReset("queryForm")}}},[e._v("重置")])],1)],1)],1)],1),r("Row",[r("Col",{attrs:{span:24}},[r("Table",{staticClass:"orderTable",attrs:{stripe:"",border:"",size:"small",columns:e.orderCol,data:e.orders},on:{"on-row-dblclick":e.handleColDbClick},scopedSlots:e._u([{key:"orderStateCode",fn:function(t){var r=t.row;return[e._v("\n          "+e._s(e._f("codeToText")(r.orderStateCode))+"\n        ")]}},{key:"orderRooms",fn:function(t){var i=t.row;return[e._l(i.orderRooms,function(t,i){return r("Row",{key:"room"+i},[r("Col",{staticStyle:{padding:"5px"},attrs:{span:24}},[r("div",{staticClass:"roomInfo",staticStyle:{width:"50px","padding-right":"0px"}},[e._v(e._s(t.guestName))]),r("div",{staticClass:"roomInfo",staticStyle:{width:"105px","padding-right":"0px"}},[e._v(e._s(t.roomName)+"（"+e._s(t.roomTypeName)+"）")]),r("div",{staticClass:"roomInfo",staticStyle:{"padding-right":"10px"}},[e._v(e._s(e._f("codeToText")(t.orderTypeCode)))]),r("div",{staticClass:"roomInfo",staticStyle:{width:"50px","padding-right":"10px"}},[e._v(e._s(t.roomPrice)+"元")]),"live"===t.orderRoomStateCode?r("div",{staticClass:"roomInfo",staticStyle:{"padding-right":"10px"}},[e._v("\n              时间："+e._s(e._f("inOutTimeFilter")(t.realInTime))+"至"+e._s(e._f("inOutTimeFilter")(t.estimateOutTime)))]):e._e(),"left"===t.orderRoomStateCode?r("div",{staticClass:"roomInfo",staticStyle:{"padding-right":"10px"}},[e._v("\n              时间："+e._s(e._f("inOutTimeFilter")(t.realInTime))+"至"+e._s(e._f("inOutTimeFilter")(t.realOutTime)))]):e._e(),"no_live"===t.orderRoomStateCode?r("div",{staticClass:"roomInfo",staticStyle:{"padding-right":"10px"}},[e._v("\n              时间："+e._s(e._f("inOutTimeFilter")(t.estimateInTime))+"至"+e._s(e._f("inOutTimeFilter")(t.estimateOutTime)))]):e._e(),r("div",{staticClass:"roomInfo",staticStyle:{"padding-right":"10px"}},[e._v(e._s(e._f("codeToText")(t.orderRoomStateCode)))])])],1)}),e._l(i.orderReserves,function(t,i){return t.allottedNum<t.reserveNum?r("Row",{key:i},[r("Col",{staticStyle:{padding:"5px"},attrs:{span:24}},[r("div",{staticClass:"roomInfo",staticStyle:{width:"70px","padding-right":"0px"}},[e._v(e._s(t.roomTypeName))]),r("div",{staticClass:"roomInfo",staticStyle:{width:"50px","padding-right":"10px"}},[e._v(e._s(t.roomTypePrice)+"元")]),r("div",{staticClass:"roomInfo",staticStyle:{"padding-right":"10px"}},[e._v(e._s(t.reserveNum)+" 间")]),r("div",{staticClass:"roomInfo",staticStyle:{width:"90px","padding-right":"10px"}},[e._v("已分配: "+e._s(t.allottedNum)+" 间")]),r("div",{staticClass:"roomInfo",staticStyle:{"padding-right":"10px"}},[e._v("\n              时间："+e._s(e._f("inOutTimeFilter")(t.estimateInTime))+" 至 "+e._s(e._f("inOutTimeFilter")(t.estimateOutTime)))]),r("div",{staticClass:"roomInfo",staticStyle:{"padding-right":"10px"}},[e._v("\n               等待分房")])])],1):e._e()})]}},{key:"action",fn:function(t){var i=t.row;return[r("a",{on:{click:function(t){e.viewOrder.orderNo=i.orderNo,e.viewOrder.openIs=!0}}},[e._v("查看详情")])]}}])})],1)],1),r("Row",[r("Col",{attrs:{span:24}},[r("Page",{attrs:{total:e.page.total,"show-total":"","prev-text":"上一页","next-text":"下一页",current:e.page.page,"page-size":e.page.limit,"page-size-opts":e.page.pageSizeOpts,"show-sizer":""},on:{"update:current":function(t){return e.$set(e.page,"page",t)},"on-change":e.getOrderList,"on-page-size-change":e.setPageSize}})],1)],1)],1),r("ViewOrder",{attrs:{"open-is":e.viewOrder.openIs,"view-order-no":e.viewOrder.orderNo},on:{viewOrderClose:function(t){e.viewOrder.openIs=!1}}})],1)},o=[],a=r("be94"),s=r("52c1"),n={orderCol:[{title:"订单号",key:"orderNo",width:180,align:"center"},{title:"创建时间",key:"gmtCreate",width:150,align:"center"},{title:"客人",key:"guestName",width:100,align:"center"},{title:"订单状态",slot:"orderStateCode",width:100,align:"center"},{title:"房间信息",slot:"orderRooms"},{title:"消费金额",key:"orderMoney",width:90,align:"center"},{title:"已交金额",key:"payMoney",width:90,align:"center"},{title:"操作",slot:"action",width:100,align:"center"}],orderRoomCol:[{title:"房号",key:"roomName",width:180,align:"center"},{title:"房价",key:"roomPrice",width:150,align:"center"},{title:"客人",key:"guestName",width:100,align:"center"}]},l=r("f8b7"),d=r("b96f"),u=r("cbf3");r("3b2b"),r("a481");Date.prototype.Format=function(e){var t={"M+":this.getMonth()+1,"d+":this.getDate(),"h+":this.getHours(),"m+":this.getMinutes(),"s+":this.getSeconds(),"q+":Math.floor((this.getMonth()+3)/3),S:this.getMilliseconds()};for(var r in/(y+)/.test(e)&&(e=e.replace(RegExp.$1,(this.getFullYear()+"").substr(4-RegExp.$1.length))),t)new RegExp("("+r+")").test(e)&&(e=e.replace(RegExp.$1,1==RegExp.$1.length?t[r]:("00"+t[r]).substr((""+t[r]).length)));return e};var m={getBusinessDate:function(e,t){if(""!==e&&null!=e&&"undefind"!==e){let r=new Date(e);return r.Format("yyyy-MM-dd")+" "+t+":00:00"}return null}},c={name:"OrderPage",components:{ViewOrder:d["a"]},filters:{inOutTimeFilter(e){return e?new Date(e).Format("MM-dd hh:mm"):""},codeToText(e){return Object(u["a"])(e)}},data(){return{orderCol:n.orderCol,orderRoomCol:n.orderRoomCol,businessDayEndHour:6,orders:[],query:{orderNo:null,startTime:"",endTime:"",ss:null,guestName:null,"orderRoomQuery.orderRoomStateCode":null,"orderRoomQuery.estimateOutTimeStart":null,"orderRoomQuery.estimateOutTimeEnd":null,"orderRoomQuery.estimateInTimeStart":null,"orderRoomQuery.estimateInTimeEnd":null,queryType:null,page:1,limit:15,sortBy:"gmtCreate",orderBy:"desc"},viewOrder:{openIs:!1,orderNo:""},page:{total:0,page:1,limit:15,pageSizeOpts:[5,10,15,20,30,40]},options1:{shortcuts:[{text:"今天",value(){return(new Date).toLocaleString()}},{text:"昨天",value(){let e=new Date;return e.setDate(e.getDate()-1),e.toLocaleString()}},{text:"前天",value(){let e=new Date;return e.setDate(e.getDate()-2),e.toLocaleString()}}]},isShowDate:!0}},computed:Object(a["a"])({conHeight(){return this.appHeight-65}},Object(s["e"])({appHeight:e=>e.webSet.appHeight,channel:e=>e.dic.channel})),mounted(){this.$nextTick(()=>{this.getOrderList()})},methods:{queryClassified(e){Object.assign(this.$data.query,this.$options.data().query),Object.assign(this.$data.page,this.$options.data().page),"all"===e&&(this.isShowDate=!0),"live"===e&&(this.isShowDate=!1,this.query["orderRoomQuery.orderRoomStateCode"]="live",this.query.queryType="live"),"out"===e&&(this.isShowDate=!1,this.query["orderRoomQuery.orderRoomStateCode"]="live",this.query["orderRoomQuery.estimateOutTimeStart"]=m.getBusinessDate(new Date,this.businessDayEndHour),this.query["orderRoomQuery.estimateOutTimeEnd"]=m.getBusinessDate((new Date).setDate((new Date).getDate()+1),this.businessDayEndHour),this.query.queryType="live"),"wait_allot"===e&&(this.isShowDate=!1,this.query.queryType="reserve"),"no_come"===e&&(this.isShowDate=!1,this.query["orderRoomQuery.orderRoomStateCode"]="no_live",this.query.queryType="reserve"),"today_come"===e&&(this.isShowDate=!1,this.query["orderRoomQuery.orderRoomStateCode"]="no_live",this.query["orderRoomQuery.estimateInTimeStart"]=m.getBusinessDate(new Date,this.businessDayEndHour),this.query["orderRoomQuery.estimateInTimeEnd"]=m.getBusinessDate((new Date).setDate((new Date).getDate()+1),this.businessDayEndHour),this.query.queryType="reserve"),this.getOrderList()},getOrderList(){this.query.page=this.page.page,this.query.limit=this.page.limit,this.query.startTime=m.getBusinessDate(this.query.startTime,this.businessDayEndHour),this.query.endTime=m.getBusinessDate(this.query.endTime,this.businessDayEndHour),Object(l["i"])(this.query).then(e=>{0===e.data.code?(this.orders=e.data.data,this.page.total=e.data.count):this.$Message.error(e.data.code+"："+e.data.msg)})},setEndTime(e){let t=new Date(e);t.setDate(t.getDate()+1),this.query.endTime=t.toLocaleString()},setPageSize(e){this.page.limit=e,this.getOrderList()},handleReset(e){this.$refs[e].resetFields()},handleColDbClick(e,t){this.viewOrder.orderNo=e.orderNo,this.viewOrder.openIs=!0}}},p=c,h=(r("6547"),r("2877")),y=Object(h["a"])(p,i,o,!1,null,null,null);t["default"]=y.exports},6547:function(e,t,r){"use strict";var i=r("ccf0"),o=r.n(i);o.a},ccf0:function(e,t,r){}}]);
//# sourceMappingURL=orderPage.fd6798d7.js.map